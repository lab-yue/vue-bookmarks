let STORAGE_KEY='BOOK-MARKS',myStorage={fetch:function(){return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]')},save:function(a){localStorage.setItem(STORAGE_KEY,JSON.stringify(a))}};Vue.component('modal',{template:'#modal-template',data(){return{bookTitle:'',bookNowPage:null,bookTotalPage:null,ErrorMsg:''}},methods:{testLegal(){let a=parseInt(this.bookNowPage)&&parseInt(this.bookTotalPage);if(!a)return this.ErrorMsg='Not numbers',!1;let b=this.bookTotalPage>=this.bookNowPage;return!!b||(this.ErrorMsg='Now page number is bigger than the Total Pages number',!1)},cancel(){this.$emit('pure-close')},close(){this.testLegal()&&this.$emit('close',{bookTitle:this.bookTitle,bookNowPage:this.bookNowPage,bookTotalPage:this.bookTotalPage,bookStartReading:new Date().toISOString().split('T')[0]})}}}),Vue.component('book',{template:'#book-template',props:['bookData','bookId'],data(){return{number:this.bookData.bookNowPage,tweenedNumber:0,isOpen:!1,showBookmarkContent:!1}},computed:{percentage(){return Math.round(1e3*(this.bookData.bookNowPage/this.bookData.bookTotalPage))/10+' %'},animatedNumber(){return this.tweenedNumber.toFixed(0)}},watch:{number:function(a){TweenLite.to(this.$data,1,{tweenedNumber:a})}},methods:{showEffect(){let a=this.isOpen?[3,2,1,0]:[0,1,2,3],b=Array.from(this.$el.getElementsByClassName('turn'));b.forEach((c,d)=>{setTimeout(()=>{c.style.zIndex=100*(a[d]+1)+'',setTimeout(()=>c.classList.toggle('open'),100)},100*a[d]+100)})},moveBookmark(a){setTimeout(()=>{this.$el.getElementsByClassName('bookmark')[0].classList.toggle('show-bookmark')},a)},putBackBookmark(){this.showBookmarkContent=!this.showBookmarkContent,this.moveBookmark(0)},takeOutBookmark(){this.moveBookmark(1e3),setTimeout(()=>{console.log(this.showBookmarkContent),this.showBookmarkContent=!this.showBookmarkContent,console.log(this.showBookmarkContent),this.number=this.bookData.bookNowPage},2e3)},closeBook(){this.putBackBookmark(),this.showEffect(),this.$emit('close',this.bookId)},openBook(){this.showEffect(),this.takeOutBookmark(),this.$emit('open',this.bookId)},toggleOpen(){this.isOpen?this.closeBook():(this.openBook(),console.log(this.$data)),this.isOpen=!this.isOpen,this.number=0}},updated(){this.number=this.bookData.bookNowPage}});let main=new Vue({el:'#main',data:{showModal:!1,showBookDetail:!1,changeView:!0,inputNum:'',selectedBookNo:null,ErrorMsg:'',books:myStorage.fetch(),showBooks:[]},watch:{books:{handler:function(a){myStorage.save(a)},deep:!0}},methods:{hideOtherBooks(a){this.selectedBookNo=a,this.changeView=!this.changeView,console.log(this.showBooks),console.log(a),this.showBooks.slice(a,1)},closeByButton(){document.getElementById('lastPage').click()},showOtherBooks(){this.selectedBookNo=null,this.changeView=!this.changeView,document.getElementsByTagName('html')[0].classList.toggle('fix'),this.showBooks.splice(0),this.showBooks=this.showBooks.concat(this.books)},checkNum(){let a=parseInt(this.inputNum),b=this.books[this.selectedBookNo];a?(b.bookNowPage=a,this.$set(this.books,this.selectedBookNo,b),this.inputNum=''):(this.ErrorMsg='  Not a Number',setTimeout(()=>this.ErrorMsg='',2e3)),console.log(this.books)},showAddBook(){this.showModal=!0},pureCloseAddBook(){this.showModal=!1},closeAddBook(a){this.showModal=!1,this.books.push(a),this.showBooks.push(a)},deleteAll(){console.log('21edcq'),this.books.splice(0),this.showBooks.splice(0)}},created(){this.showBooks=this.showBooks.concat(this.books)}});